<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bible Bison</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="icon" href="img/bilboicon01.png" type="image/png">
</head>

<body>
  <h1>Verse of the Day</h1>

  <!-- Date & optional time -->
  <div id="datetime">
    <p id="date"></p>
    <!--<p id="time"></p>--> <!-- uncomment if you want live time -->
  </div>

  <script>
    function updateDateTime() {
      const now = new Date();
      const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      const date = now.toLocaleDateString(undefined, options);
      const time = now.toLocaleTimeString();

      document.getElementById("date").textContent = date;
      document.getElementById("time").textContent = time;
    }
    updateDateTime();
    setInterval(updateDateTime, 1000);
  </script>

  <!-- Verse of the Day -->
  <div id="verse" class="fade-in"></div>

  <script>
    async function loadVerse() {
      try {
        let response = await fetch("https://beta.ourmanna.com/api/v1/get/?format=text");
        let verse = await response.text();
        document.getElementById("verse").innerText = verse;
      } catch (e) {
        document.getElementById("verse").innerText = "Verse of the Day unavailable.";
      }
    }
    loadVerse();
  </script>

  <!-- Bilbo Image -->
  <img src="img/Bilbo_The_Bison777.png" class="centered-image">




<!-- Jitsi Connect Button -->
<button id="connectBtn">Discuss Verse</button>

<!-- Container for embedded Jitsi Meet -->
<div id="jitsiContainer" style="width: 100%; height: 500px; margin-top: 20px;"></div>

<script src="https://meet.jit.si/external_api.js"></script>
<script>
  const connectBtn = document.getElementById("connectBtn");
  const jitsiContainer = document.getElementById("jitsiContainer");
  let api = null; // store Jitsi instance globally

  connectBtn.onclick = () => {
    // Room name â€” same for everyone
    const roomName = "BibleBison123";

    // Clear previous Jitsi instance if exists
    jitsiContainer.innerHTML = "";

    const options = {
      roomName: roomName,
      width: "100%",
      height: 500,
      parentNode: jitsiContainer,
      interfaceConfigOverwrite: {
        TOOLBAR_BUTTONS: ["microphone", "camera", "hangup", "chat"]
      }
    };

    // Create new Jitsi Meet instance
    api = new JitsiMeetExternalAPI("meet.jit.si", options);

    // Listen for when user leaves the conference
    api.addEventListener("videoConferenceLeft", () => {
      // Remove iframe / container content
      jitsiContainer.innerHTML = "";
      api = null;
    });
  };
</script>

</body>
</html>
